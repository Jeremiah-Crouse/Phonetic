<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>THE ORACLE</title>
    <style>
        body { 
            background: #0a0a0a; 
            color: #d1d1d1; 
            font-family: 'Georgia', serif; 
            margin: 0; 
            padding: 0; 
            display: flex; 
            flex-direction: column; 
            height: 100vh;
        }
        #chat-flow {
            flex-grow: 1;
            overflow-y: auto;
            padding: 40px 20vw;
            display: flex;
            flex-direction: column;
            gap: 30px;
        }
        .message { max-width: 80%; line-height: 1.6; animation: fadeIn 0.8s ease; }
        .user-query {
            align-self: flex-end;
            color: #666;
            font-style: italic;
            font-size: 0.9em;
            text-align: right;
        }
        .oracle-response {
            align-self: flex-start;
            color: #e0e0e0;
            font-size: 1.2em;
            border-left: 2px solid #444;
            padding-left: 20px;
        }
        .oracle-response::first-letter {
            font-size: 1.5em;
            color: #fff;
        }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        
        .input-container {
            padding: 30px 20vw;
            background: #0a0a0a;
            border-top: 1px solid #1a1a1a;
        }
        input {
            background: transparent;
            border: none;
            color: #fff;
            width: 100%;
            font-size: 1.1em;
            outline: none;
            font-family: 'Georgia', serif;
            placeholder-color: #333;
        }
        .loading-dots:after {
            content: ' .';
            animation: dots 1s steps(5, end) infinite;
        }
        @keyframes dots { 0%, 20% { color: rgba(0,0,0,0); text-shadow: .5em 0 0 rgba(0,0,0,0), 1em 0 0 rgba(0,0,0,0); } 40% { color: #666; text-shadow: .5em 0 0 rgba(0,0,0,0), 1em 0 0 rgba(0,0,0,0); } 60% { text-shadow: .5em 0 0 #666, 1em 0 0 rgba(0,0,0,0); } 80%, 100% { text-shadow: .5em 0 0 #666, 1em 0 0 #666; } }
    </style>
</head>
<body>

    <div id="chat-flow">
        <div class="message oracle-response">
            The Oracle is listening. Speak your truth or ask your name.
        </div>
    </div>

    <div class="input-container">
        <input type="text" id="userInput" placeholder="Type your message..." autofocus autocomplete="off">
    </div>

    <script>
        const input = document.getElementById('userInput');
        const flow = document.getElementById('chat-flow');
        const API_URL = 'https://phonetic-rr67.onrender.com/oracle';

        input.addEventListener('keypress', async (e) => {
            if (e.key === 'Enter' && input.value.trim() !== '') {
                const text = input.value.trim();
                input.value = '';
                
                // Show User Query
                flow.innerHTML += `<div class="message user-query">${text}</div>`;
                
                // Show Loading
                const loading = document.createElement('div');
                loading.className = 'message oracle-response loading-dots';
                loading.innerText = 'Consulting the patterns';
                flow.appendChild(loading);
                flow.scrollTop = flow.scrollHeight;

                try {
                    const response = await fetch(API_URL, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ name: text })
                    });

                    const data = await response.json();
                    loading.classList.remove('loading-dots');
                    loading.innerText = data.interpretation;
                    
                } catch (err) {
                    loading.innerText = "The connection to the patterns has been severed.";
                    loading.style.color = "#800";
                }
                
                flow.scrollTop = flow.scrollHeight;
            }
        });
    </script>
</body>
</html>